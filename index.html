<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Moodle Tools - Faux Virus Smiley</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #121212;
    color: white;
    margin: 0; padding: 20px;
  }
  button {
    background-color: #0078d7;
    border: none;
    color: white;
    padding: 10px 20px;
    margin: 10px;
    font-size: 1em;
    border-radius: 4px;
    cursor: pointer;
    user-select: none;
  }
  /* Smiley rouge clignotant */
  .smiley {
    position: fixed;
    font-size: 24px;
    color: red;
    animation: blink 1s infinite;
    pointer-events: none;
    user-select: none;
  }
  @keyframes blink {
    0%, 50%, 100% {opacity: 1;}
    25%, 75% {opacity: 0;}
  }
  /* Faux popup Windows style */
  .fake-popup {
    position: fixed;
    background: #e1e1e1;
    border: 2px solid #000;
    box-shadow: 4px 4px 10px rgba(0,0,0,0.8);
    width: 320px;
    padding: 15px;
    z-index: 10000;
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
  }
  .fake-popup-header {
    background: #0078d7;
    color: white;
    padding: 5px 10px;
    font-weight: bold;
    user-select: none;
  }
  .fake-popup-content {
    margin-top: 10px;
    color: black;
  }
  .fake-popup-button {
    margin-top: 15px;
    float: right;
    padding: 5px 10px;
    background: #0078d7;
    color: white;
    border: none;
    cursor: pointer;
  }
</style>
</head>
<body>

<h1>Moodle Tools</h1>

<!-- Exemple de boutons du site -->
<button>Importer une image</button>
<button>Créer une vidéo</button>
<button>Exporter</button>

<script>
// Fonction pour générer un smiley rouge clignotant à une position aléatoire
function createSmiley() {
  const smiley = document.createElement('div');
  smiley.className = 'smiley';
  smiley.textContent = ':)';
  smiley.style.top = Math.random() * (window.innerHeight - 30) + 'px';
  smiley.style.left = Math.random() * (window.innerWidth - 30) + 'px';
  document.body.appendChild(smiley);

  // Supprime le smiley après 3 secondes pour éviter trop d'accumulation
  setTimeout(() => {
    smiley.remove();
  }, 3000);
}

// Fonction pour créer un faux popup Windows
function createFakePopup(message, x, y) {
  const popup = document.createElement('div');
  popup.className = 'fake-popup';
  popup.style.top = y + 'px';
  popup.style.left = x + 'px';

  popup.innerHTML = `
    <div class="fake-popup-header">Windows Defender</div>
    <div class="fake-popup-content">${message}</div>
    <button class="fake-popup-button">OK</button>
  `;

  document.body.appendChild(popup);

  const btn = popup.querySelector('button');
  btn.addEventListener('click', () => popup.remove());

  // Auto ferme au bout de 6 secondes
  setTimeout(() => {
    if (popup.parentElement) popup.remove();
  }, 6000);
}

// Fonction principale déclenchée par un clic sur un bouton
function triggerFakeVirus() {
  // Lance 50 smileys en 3 secondes
  let count = 0;
  const max = 50;
  const interval = setInterval(() => {
    createSmiley();
    count++;
    if(count >= max) clearInterval(interval);
  }, 60);

  // Lance plusieurs popups à différents endroits aléatoires
  const messages = [
    "Menace détectée : Trojan.Win32.Generic",
    "Analyse antivirus en cours...",
    "Suppression du fichier infecté impossible",
    "Erreur critique du système détectée",
    "Attention : activité suspecte détectée",
    "Le système va redémarrer pour appliquer les mises à jour"
  ];

  let popupCount = 0;
  const popupInterval = setInterval(() => {
    if(popupCount >= messages.length) {
      clearInterval(popupInterval);
      return;
    }
    const x = Math.random() * (window.innerWidth - 350);
    const y = Math.random() * (window.innerHeight - 150);
    createFakePopup(messages[popupCount], x, y);
    popupCount++;
  }, 1500);
}

// Ajout des listeners sur tous les boutons pour remplacer leur fonction par le faux virus
document.querySelectorAll('button').forEach(btn => {
  btn.addEventListener('click', e => {
    e.preventDefault();
    triggerFakeVirus();
  });
});
</script>

</body>
</html>
